"use client";

import React, { forwardRef } from "react";

interface FileUploadProps {
  handleFileChange: (e: React.ChangeEvent<HTMLInputElement>) => void;
  fileLoading: boolean;
  resetUpload: () => void;
}

const FileUpload = forwardRef<HTMLInputElement, FileUploadProps>(
  ({ handleFileChange, fileLoading, resetUpload }, ref) => {
    return (
      <div className="flex items-center justify-center w-full">
        <label
          htmlFor="dropzone-file"
          className="flex flex-col items-center justify-center w-full h-80 bg-zinc-50 appearance-none border border-gray-200 rounded cursor-pointer hover:bg-zinc-100"
        >
          {fileLoading ? (
            <div className="flex flex-col items-center justify-center pt-5 pb-6">
              <div role="status">
                <svg
                  aria-hidden="true"
                  className="w-12 h-12 text-gray-200 animate-spin dark:text-gray-600 fill-green-600"
                  viewBox="0 0 100 101"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
                    fill="currentColor"
                  />
                  <path
                    d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
                    fill="currentFill"
                  />
                </svg>
                <span className="sr-only">Loading...</span>
              </div>
              <p className="text-sm mt-2 text-zinc-700 font-light">
                Uploading...
              </p>
              <button
                onClick={resetUpload}
                className="bg-zinc-50 hover:bg-zinc-200 w-16 text-zinc-500 border border-zinc-500 py-1 px-1 my-2 rounded text-xs"
              >
                Cancel
              </button>
              <p className="text-xs text-zinc-500 font-light">
                Supported Formats: xlsx, csv
              </p>
            </div>
          ) : (
            <div className="flex flex-col items-center justify-center pt-5 pb-6">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="70"
                height="61"
                viewBox="0 0 70 61"
                fill="none"
              >
                <path
                  d="M36.6364 15.4529L36.7287 15.4804L36.7327 15.4758C37.1703 15.5551 37.6045 15.2931 37.7331 14.8589C38.9047 10.9222 42.5958 8.17207 46.7082 8.17207C47.1951 8.17207 47.59 7.77719 47.59 7.29033C47.59 6.80346 47.1951 6.40859 46.7082 6.40859C41.6541 6.40859 37.4069 9.77368 36.0432 14.3564C35.904 14.8232 36.1699 15.3137 36.6364 15.4529Z"
                  fill="#EF3340"
                  stroke="#F9FFF9"
                  strokeWidth="0.3"
                />
                <path
                  d="M56.9522 43.1455H52.5618C52.1578 43.1455 51.8301 42.8177 51.8301 42.4137C51.8301 42.0097 52.1578 41.682 52.5618 41.682H56.9522C63.004 41.682 67.9281 36.7579 67.9281 30.706C67.9281 24.6541 63.004 19.7301 56.9522 19.7301H56.8466C56.6344 19.7301 56.4326 19.6381 56.2936 19.4776C56.1546 19.3172 56.0918 19.1044 56.1222 18.8943C56.1875 18.4386 56.2204 17.9807 56.2204 17.5349C56.2204 12.29 51.9528 8.02234 46.7079 8.02234C44.6674 8.02234 42.7215 8.65999 41.0803 9.86681C40.7196 10.1318 40.2074 10.0142 39.9989 9.6175C35.3509 0.766731 23.2107 -0.421837 16.9166 7.27756C14.2652 10.5212 13.2234 14.7407 14.0582 18.8531C14.1502 19.3073 13.8026 19.7306 13.3411 19.7306H13.0479C6.996 19.7306 2.07193 24.6547 2.07193 30.7066C2.07193 36.7585 6.996 41.6825 13.0479 41.6825H17.4382C17.8422 41.6825 18.1699 42.0102 18.1699 42.4143C18.1699 42.8183 17.8422 43.146 17.4382 43.146H13.0479C6.1889 43.146 0.608398 37.5655 0.608398 30.7065C0.608398 24.04 5.87995 18.5812 12.4735 18.2802C11.8541 14.0136 13.0385 9.70998 15.7835 6.3514C22.5222 -1.89257 35.4364 -0.968527 40.8955 8.2241C42.6371 7.13225 44.6299 6.55947 46.7076 6.55947C53.0622 6.55947 58.0976 11.968 57.657 18.287C64.1897 18.6534 69.3913 24.0833 69.3913 30.706C69.3913 37.5655 63.8108 43.1455 56.9518 43.1455L56.9522 43.1455Z"
                  fill="#EF3340"
                />
                <path
                  d="M16.4584 42.0005C16.4584 52.1705 24.7321 60.444 34.9019 60.444C45.0718 60.444 53.3454 52.1703 53.3454 42.0005C53.3454 31.8306 45.0718 23.557 34.9019 23.557C24.7319 23.557 16.4584 31.8307 16.4584 42.0005ZM18.2222 42.0005C18.2222 32.8036 25.7048 25.3208 34.9019 25.3208C44.0988 25.3208 51.5816 32.8035 51.5816 42.0005C51.5816 51.1974 44.0988 58.6802 34.9019 58.6802C25.705 58.6802 18.2222 51.1975 18.2222 42.0005Z"
                  fill="#EF3340"
                  stroke="#F9FFF9"
                  strokeWidth="0.3"
                />
                <path
                  d="M34.5512 49.3647C34.5512 49.7433 34.8583 50.0504 35.2369 50.0504C35.6154 50.0504 35.9226 49.7438 35.9226 49.3647V35.4361C35.9226 35.0575 35.6155 34.7504 35.2369 34.7504C34.8582 34.7504 34.5512 35.0575 34.5512 35.4361V49.3647Z"
                  fill="#EF3340"
                  stroke="#483EA8"
                  strokeWidth="0.3"
                />
                <path
                  d="M35.2365 36.4079L31.4358 40.2086L35.2365 36.4079ZM35.2365 36.4079L39.0373 40.2087C39.171 40.3424 39.347 40.4095 39.5221 40.4095L35.2365 36.4079ZM30.466 40.2087C30.7338 40.4765 31.1681 40.4766 31.4357 40.2087L39.5222 40.4095C39.697 40.4095 39.8731 40.343 40.0071 40.2086C40.2749 39.9407 40.2749 39.5068 40.007 39.2389L35.7214 34.9533C35.4536 34.6855 35.0192 34.6853 34.7516 34.9533C34.7516 34.9533 34.7515 34.9533 34.7515 34.9534L30.466 39.2389C30.1981 39.5068 30.1981 39.9408 30.466 40.2087Z"
                  fill="#EF3340"
                  stroke="#483EA8"
                  strokeWidth="0.3"
                />
              </svg>
              <p className="mb-2 text-sm font-light">
                Drag & Drop Files or{" "}
                <span className="text-sky-700 underline">Browse</span>
              </p>
              <p className="text-xs text-zinc-500 font-light">
                Supported Formats: xlsx, csv
              </p>
            </div>
          )}

          <input
            ref={ref}
            id="dropzone-file"
            disabled={fileLoading}
            onChange={handleFileChange}
            type="file"
            className="hidden"
            accept=".csv,.xlsx"
          />
        </label>
      </div>
    );
  }
);

FileUpload.displayName = "FileUpload";

export default FileUpload;
